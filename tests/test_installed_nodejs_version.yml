---

- name: "retrieve installed NodeJS version"
  command: |
    node -p "'node_' + Number(process.version.match(/^v([0-9]+).*$/)[1]) + '.x'"
  register: "_result"
  changed_when: False

- name: "fail when installed NodeJS version does not match the expected one"
  fail:
    msg: "NodeJS version: {{ _result.stdout }} != {{ nodejs_version }}"
  when:
    - "_result.stdout != nodejs_version"
